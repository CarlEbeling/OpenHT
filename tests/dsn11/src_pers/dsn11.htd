#define INC_HTID_W 5

typedef sc_uint<INC_HTID_W> HtId_t;
typedef sc_uint<48> MemAddr_t;

struct CStruct {
	uint64_t m_u6:6;
	uint64_t m_u3:3;
};

////////////////////////////////////////////////////
// Inc Module

dsnInfo.AddModule(name=inc, htIdW=INC_HTID_W);

inc.AddInst(name=INC_INIT);
inc.AddInst(name=INC_READ);
inc.AddInst(name=INC_WRITE);

inc.AddHostMsg(dir=in, name=SU_ARRAY_ADDR)
	.AddDst(var=arrayAddr, dataLsb=0)
	;

inc.AddPrivate()
	.AddVar(type=uint8_t, name=elemCnt)
	.AddVar(type=uint8_t, name=loopCnt)
	.AddVar(type=HtId_t, name=arrayMemRdPtr)
	;

inc.AddShared()
	.AddVar(type=MemAddr_t, name=arrayAddr)
	.AddVar(type=bool, name=pb)
	.AddVar(type=ht_uint4, name=pu4)
	;

inc.AddEntry(func=htmain, inst=INC_INIT, host=true)
	.AddParam(hostType=uint32_t, type=uint8_t, name=elemCnt)
	;

inc.AddReturn(func=htmain)
	.AddParam(hostType=uint32_t, type=uint8_t, name=elemCnt)
	;

#define CALL_INC2	// _src does not call INC2, seems like htl should not generate inc2 if not defined - bug?
#ifdef CALL_INC2
inc.AddCall(func=inc2)
	;
#endif

inc.AddReadMem(queueW=5, rspCntW=1, maxBw=true)
	.AddDst(var=arrayMem, field=data);
inc.AddWriteMem(maxBw=true);

inc.AddGlobal(var=arrayMem, addr1W=INC_HTID_W, addr1=arrayMemRdPtr)
	.AddField(type=uint64_t, name=data, read=true, write=true)
	;

inc.AddGlobal(var=arrayMem2, addr1W=INC_HTID_W, addr1=arrayMemRdPtr)
	.AddField(type=uint64_t, name=data, read=true, write=true)
	;

inc.AddFunction(type=bool, name=fb);
inc.AddFunction(type=ht_uint4, name=fu4);
inc.AddFunction(type=ht_uint4, name=fp1)
	.AddParam(dir=input, type=ht_uint4, name=a)
	.AddParam(dir=input, type=ht_uint4, name=b)
	;
inc.AddFunction(type=CStruct, name=fs);
inc.AddFunction(type=ht_uint4, name=fg)
	.AddParam(dir=input, type=ht_uint4, name=a)
	.AddParam(dir=inout, type=ht_uint4, name=b)
	.AddParam(dir=output, type=ht_uint4, name=c)
	;
inc.AddFunction(type=ht_uint4, name=fl)
	.AddParam(dir=input, type=ht_uint4, name=a)
	.AddParam(dir=inout, type=ht_uint4, name=b)
	.AddParam(dir=output, type=ht_uint4, name=c)
	;

////////////////////////////////////////////////////
// Inc2 Module

#define INC2_HTID_W 5
dsnInfo.AddModule(name=inc2, htIdW=INC2_HTID_W);

inc2.AddInst(name=INC2_INIT);


inc2.AddGlobal(var=arrayMem2, addr1W=INC_HTID_W, extern=true)
	.AddField(type=uint64_t, name=data, read=false, write=true)
	;

inc2.AddEntry(func=inc2, inst=INC2_INIT)
	;

inc2.AddReturn(func=inc2)
	;
